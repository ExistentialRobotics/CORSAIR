Largely borrowed
from [FCGF](https://github.com/chrischoy/FCGF/tree/master/model)
